{% extends 'base.html' %}

{% block content %}
<div class="row justify-content-center">
    <div class="col-md-8">
        <h2 class="mb-4">{{ title }}</h2>
        <form method="post" class="card p-4 shadow-sm">
            <div class="mb-3">
                <label class="form-label">Название (RU)</label>
                <input type="text" name="title_ru" class="form-control" value="{{ work.title_ru if work else '' }}" required>
            </div>
            
            <div class="row">
                <div class="col-md-6 mb-3">
                    <label class="form-label">Оригинальное название</label>
                    <input type="text" name="title_original" class="form-control" value="{{ work.title_original if work else '' }}">
                </div>
                <div class="col-md-3 mb-3">
                    <label class="form-label">Год</label>
                    <input type="number" name="publication_year" class="form-control" value="{{ work.publication_year if work else '' }}" required>
                </div>
                <div class="col-md-3 mb-3">
                    <label class="form-label">Тип</label>
                    <select name="work_type" class="form-select">
                        {% set current_type = work.work_type if work else '' %}
                        <option value="Роман" {% if current_type == 'Роман' %}selected{% endif %}>Роман</option>
                        <option value="Повесть" {% if current_type == 'Повесть' %}selected{% endif %}>Повесть</option>
                        <option value="Рассказ" {% if current_type == 'Рассказ' %}selected{% endif %}>Рассказ</option>
                    </select>
                </div>
            </div>

            <div class="row bg-light p-2 rounded mb-3">
                <div class="col-md-9">
                    <label class="form-label">Цикл</label>
                    <select name="cycle_id" class="form-select">
                        <option value="">-- Вне цикла --</option>
                        {% for c in cycles %}
                            <option value="{{ c.id }}" {% if work and work.cycle_id == c.id %}selected{% endif %}>
                                {{ c.title_ru }}
                            </option>
                        {% endfor %}
                    </select>
                </div>
                <div class="col-md-3">
                    <label class="form-label">Порядок в цикле</label>
                    <input type="number" step="0.1" name="cycle_order" class="form-control" value="{{ work.cycle_order if work and work.cycle_order else '' }}">
                </div>
            </div>

            <div class="mb-3">
                <label class="form-label">Описание</label>
                <textarea name="description" class="form-control" rows="5">{{ work.description if work else '' }}</textarea>
            </div>

            <button type="submit" class="btn btn-success">Сохранить</button>
            <a href="{{ url_for('index') }}" class="btn btn-secondary">Отмена</a>
        </form>
    </div>
</div>
{% endblock %}